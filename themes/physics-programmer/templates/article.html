{% extends "base.html" %}

{% block title %}{{ article.title }} - {{ SITENAME }}{% endblock title %}

{% block description %}{{ article.summary or article.content|striptags|truncate(160) }}{% endblock description %}

{% block keywords %}{{ article.tags|join(', ') }}{% endblock keywords %}

{% block og_type %}article{% endblock og_type %}

{% block body_class %}article-page{% endblock body_class %}

{% block structured_data %}
{{ super() }}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "{{ article.title }}",
    "description": "{{ article.summary or article.content|striptags|truncate(160) }}",
    "author": {
        "@type": "Person",
        "name": "{{ AUTHOR }}"
    },
    "datePublished": "{{ article.date.isoformat() }}",
    {% if article.modified %}
    "dateModified": "{{ article.modified.isoformat() }}",
    {% endif %}
    "publisher": {
        "@type": "Organization",
        "name": "{{ SITENAME }}",
        "url": "{{ SITEURL }}"
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ SITEURL }}/{{ article.url }}"
    }
}
</script>
{% endblock structured_data %}

{% block content %}
<article class="article-container">
    <header class="article-header">
        <div class="container">
            <div class="article-breadcrumb">
                <nav aria-label="Breadcrumb">
                    <ol class="breadcrumb">
                        <li><a href="{{ SITEURL }}/">Home</a></li>
                        <li><a href="{{ SITEURL }}/{{ article.category.url }}">{{ article.category|format_project_type }}</a></li>
                        <li aria-current="page">{{ article.title }}</li>
                    </ol>
                </nav>
            </div>
            
            <div class="article-meta-top">
                <span class="article-category">{{ article.category|format_project_type }}</span>
                <time class="article-date" datetime="{{ article.date.isoformat() }}">
                    {{ article.date.strftime('%B %d, %Y') }}
                </time>
                {% if article.modified %}
                <span class="article-modified">
                    Updated: {{ article.modified.strftime('%B %d, %Y') }}
                </span>
                {% endif %}
            </div>
            
            <h1 class="article-title">{{ article.title }}</h1>
            
            {% if article.summary %}
            <p class="article-summary">{{ article.summary }}</p>
            {% endif %}
            
            {% if article.technologies or article.tags %}
            <div class="article-tags">
                {% if article.technologies %}
                <div class="tag-group">
                    <span class="tag-label">Technologies:</span>
                    {% for tech in article.technologies %}
                    <span class="tech-tag">{{ tech }}</span>
                    {% endfor %}
                </div>
                {% endif %}
                
                {% if article.tags %}
                <div class="tag-group">
                    <span class="tag-label">Tags:</span>
                    {% for tag in article.tags %}
                    <a href="{{ SITEURL }}/{{ tag.url }}" class="content-tag">{{ tag }}</a>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% endif %}
        </div>
    </header>
    
    <div class="article-content">
        <div class="container">
            <div class="content-wrapper">
                <main class="article-main">
                    {% if article.project_type %}
                    <div class="project-info">
                        <h2>Project Information</h2>
                        <dl class="project-details">
                            <dt>Type</dt>
                            <dd>{{ article.project_type|format_project_type }}</dd>
                            
                            {% if article.funding_source %}
                            <dt>Funding</dt>
                            <dd>{{ article.funding_source }}</dd>
                            {% endif %}
                            
                            {% if article.collaboration_type %}
                            <dt>Collaboration</dt>
                            <dd>{{ article.collaboration_type }}</dd>
                            {% endif %}
                            
                            {% if article.status %}
                            <dt>Status</dt>
                            <dd>{{ article.status }}</dd>
                            {% endif %}
                            
                            {% if article.duration %}
                            <dt>Duration</dt>
                            <dd>{{ article.duration }}</dd>
                            {% endif %}
                        </dl>
                    </div>
                    {% endif %}
                    
                    <div class="article-body">
                        {{ article.content }}
                    </div>
                    
                    {% if article.repository_url or article.demo_url or article.paper_url %}
                    <div class="project-links">
                        <h3>Resources</h3>
                        <div class="resource-links">
                            {% if article.repository_url %}
                            <a href="{{ article.repository_url }}" class="resource-link" target="_blank" rel="noopener noreferrer">
                                <span class="link-icon">üìÅ</span>
                                View Repository
                            </a>
                            {% endif %}
                            
                            {% if article.demo_url %}
                            <a href="{{ article.demo_url }}" class="resource-link" target="_blank" rel="noopener noreferrer">
                                <span class="link-icon">üöÄ</span>
                                Live Demo
                            </a>
                            {% endif %}
                            
                            {% if article.paper_url %}
                            <a href="{{ article.paper_url }}" class="resource-link" target="_blank" rel="noopener noreferrer">
                                <span class="link-icon">üìÑ</span>
                                Research Paper
                            </a>
                            {% endif %}
                        </div>
                    </div>
                    {% endif %}
                </main>
                
                <aside class="article-sidebar">
                    {% if article.toc %}
                    <div class="table-of-contents">
                        <h3>Contents</h3>
                        {{ article.toc }}
                    </div>
                    {% endif %}
                    
                    <div class="article-meta">
                        <h3>Article Info</h3>
                        <dl class="meta-details">
                            <dt>Published</dt>
                            <dd>{{ article.date.strftime('%B %d, %Y') }}</dd>
                            
                            {% if article.modified %}
                            <dt>Last Updated</dt>
                            <dd>{{ article.modified.strftime('%B %d, %Y') }}</dd>
                            {% endif %}
                            
                            <dt>Category</dt>
                            <dd>
                                <a href="{{ SITEURL }}/{{ article.category.url }}">
                                    {{ article.category|format_project_type }}
                                </a>
                            </dd>
                            
                            {% if article.authors %}
                            <dt>Authors</dt>
                            <dd>{{ article.authors|join(', ') }}</dd>
                            {% endif %}
                            
                            <dt>Reading Time</dt>
                            <dd>{{ (article.content|wordcount / 200)|round|int }} min read</dd>
                        </dl>
                    </div>
                    
                    {% if SOCIAL %}
                    <div class="share-article">
                        <h3>Share</h3>
                        <div class="share-buttons">
                            <a href="https://twitter.com/intent/tweet?text={{ article.title|urlencode }}&url={{ SITEURL }}/{{ article.url }}" 
                               class="share-btn twitter" target="_blank" rel="noopener noreferrer"
                               aria-label="Share on Twitter">
                                Twitter
                            </a>
                            <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ SITEURL }}/{{ article.url }}" 
                               class="share-btn linkedin" target="_blank" rel="noopener noreferrer"
                               aria-label="Share on LinkedIn">
                                LinkedIn
                            </a>
                        </div>
                    </div>
                    {% endif %}
                </aside>
            </div>
        </div>
    </div>
    
    <footer class="article-footer">
        <div class="container">
            {% if article.prev_article or article.next_article %}
            <nav class="article-navigation" aria-label="Article navigation">
                {% if article.prev_article %}
                <div class="nav-previous">
                    <span class="nav-label">Previous Project</span>
                    <a href="{{ SITEURL }}/{{ article.prev_article.url }}" class="nav-link">
                        {{ article.prev_article.title }}
                    </a>
                </div>
                {% endif %}
                
                {% if article.next_article %}
                <div class="nav-next">
                    <span class="nav-label">Next Project</span>
                    <a href="{{ SITEURL }}/{{ article.next_article.url }}" class="nav-link">
                        {{ article.next_article.title }}
                    </a>
                </div>
                {% endif %}
            </nav>
            {% endif %}
            
            {% if article.related_posts %}
            <section class="related-articles">
                <h3>Related Projects</h3>
                <div class="related-grid">
                    {% for related in article.related_posts[:3] %}
                    <article class="related-card">
                        <h4 class="related-title">
                            <a href="{{ SITEURL }}/{{ related.url }}">{{ related.title }}</a>
                        </h4>
                        <p class="related-summary">{{ related.summary|truncate(100) }}</p>
                        <span class="related-category">{{ related.category|format_project_type }}</span>
                    </article>
                    {% endfor %}
                </div>
            </section>
            {% endif %}
        </div>
    </footer>
</article>
{% endblock content %}